<!-- Utilities for Will-Myers.com Plugins -->
<script src="https://cdn.jsdelivr.net/gh/willmyerscode/toolkit@1/index.min.js"></script>

<!-- Tabs CSS (safe to leave global) -->
<link href="https://cdn.jsdelivr.net/gh/willmyerscode/tabs@5/tabs.min.css" rel="stylesheet">

<!-- Page hook -->
<script>document.documentElement.classList.add('apreps');</script>

<!-- Safety CSS: hide any ghost/empty injected galleries not in the real section -->
<style>
  /* Hide any section that contains a gallery but no slides/items */
  section:has(.sqs-gallery-block):not(#artist-gallery)
    :is(:has(.sqs-gallery-item), :has(img), :has(picture)) { /* do nothing when real items exist */ }

  section:has(.sqs-gallery-block):not(#artist-gallery)
    :not(:has(.sqs-gallery-item, img, picture)) {
    display: none !important;
    height: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Belt & braces: kill obviously empty gallery wrappers */
  .sqs-gallery-block:empty,
  .sqs-gallery-block .sqs-gallery-design-strip:empty,
  .sqs-gallery-block-grid:empty {
    display: none !important;
  }
</style>

<!-- Guard + cleanup: only allow galleries inside #artist-gallery, remove empties elsewhere -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const root = document.querySelector('#artist-gallery');

  // If the section isn't present, bail (prevents plugin doing weird stuff on other pages)
  if (!root) return;

  // Remove any empty gallery sections outside the scoped section (in case a plugin injected them)
  const killEmpties = () => {
    document.querySelectorAll('section').forEach(section => {
      if (section.contains(root)) return; // skip the real section
      const g = section.querySelector('.sqs-gallery-block');
      if (!g) return;
      const hasItems = g.querySelector('.sqs-gallery-item, img, picture, .thumb-image, .slide');
      if (!hasItems) section.remove(); // or: section.style.display = 'none';
    });
  };

  // Run now and also watch for late-injected ghosts
  killEmpties();
  const obs = new MutationObserver(killEmpties);
  obs.observe(document.body, { childList: true, subtree: true });

  // Optional: expose the scoped root for any footer init that can accept a container
  window.APREPS_GALLERY_ROOT = root;
});
</script>

<!-- Dot Cursor by digitalmoves.com.au -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const cursor = document.createElement("span");
  cursor.classList.add("dot-cursor");
  cursor.innerHTML = "<span />";
  cursor.style.opacity = 0;
  document.body.appendChild(cursor);

  document.addEventListener("mousemove", (e) => {
    if (e.clientX < 3 || e.clientY < 3) {
      cursor.style.opacity = 0;
    } else {
      cursor.style.opacity = 1;
      cursor.style.transform = `translate(${e.clientX}px, ${e.clientY}px)`;
    }
  });

  document.querySelectorAll("a, button").forEach((t) => {
    t.addEventListener("mouseenter", () => cursor.classList.add("active"));
    t.addEventListener("mouseleave", () => cursor.classList.remove("active"));
  });
});
</script>